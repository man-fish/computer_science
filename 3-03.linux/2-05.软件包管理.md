## linux 的软件包管理

-------

#### 为什么需要软件包管理软件？

`Linux` 发行版本质量最重要的决定因素是软件包管理系统和其支持社区的持久性。随着我们花更多的时间在 `Linux` 上，我们会发现它的软件园地是非常动态的。软件不断变化。大多数一线 `Linux` 发行版每隔六个月发布一个新版本，并且许多独立的程序每天都会更新。为了能和这些如暴风雪一般多的软件保持联系，我们需要一些好工具来进行软件包管理。

#### 软件包管理系统是怎样工作？

`Linux` 系统中几乎所有的软件都可以在互联网上找到。其中大多数软件由发行商以包文件的形式提供，剩下的部分软件则以源码形式存在，可以手动安装。

**包文件**

在包管理系统中软件的基本单元是包文件。包文件是一个构成软件包的文件压缩集合。一个软件包可能由大量程序以及支持这些程序的数据文件组成。除了安装文件之外，软件包文件也包括 关于这个包的元数据，如软件包及其内容的文本说明。另外，许多软件包还包括预安装和安装后脚本， 这些脚本用来在软件安装之前和之后执行配置任务。

软件包文件是由软件包维护者创建的，他通常是（但不总是）一名软件发行商的雇员。软件维护者 从上游提供商（程序作者）那里得到软件源码，然后编辑源码，创建软件包元数据以及所需要的 安装脚本。通常，软件包维护者要把所做的修改应用到最初的源码当中，来提高此软件与 `Linux` 发行版其它部分的融合性。

**资源库**

虽然某些软件项目选择执行他们自己的打包和发布策略，但是现在大多数软件包是由发行商和感兴趣的第三方创建的。系统发行版的用户可以在一个中心资源库中得到这些软件包，这个资源库可能 包含了成千上万个软件包，每一个软件包都是专门为这个系统发行版建立和维护的。

**依赖性**

程序很少是”孤立的”，而是依赖于其它软件组件来完成它们的工作。常见活动，以 输入/输出为例，就是由共享程序例程来处理的。这些程序例程存储在共享库中，共享库不只为一个程序提供基本服务。如果一个软件包需要共享资源，比如说共享库，据说就有一个依赖。 现代的软件包管理系统都提供了一些依赖项解析方法，以此来确保当安装软件包时，也安装了其所有的依赖程序。

## 打包系统

------

不同的 `Linux` 发行版使用不同的打包系统，大多数发行版分别属于两大包管理技术阵营： `Debian`的`.deb`，和红帽的`.rpm`。

| 包管理系统           | 发行版 (部分列表)                                            |
| :------------------- | :----------------------------------------------------------- |
| Debian Style (.deb)  | Debian, Ubuntu, Xandros, Linspire                            |
| Red Hat Style (.rpm) | Fedora, CentOS, Red Hat Enterprise Linux, OpenSUSE, Mandriva, PCLinuxOS |

#### 上层和底层软件包工具

软件包管理系统通常由两种工具类型组成：底层工具用来处理这些任务，比方说安装和删除软件包文件， 和上层工具，完成元数据搜索和依赖解析。

**包管理工具:**

| 发行版                                   | 底层工具 | 上层工具          |
| :--------------------------------------- | :------- | :---------------- |
| Debian-Style                             | dpkg     | apt-get, aptitude |
| Fedora, Red Hat Enterprise Linux, CentOS | rpm      | yum               |

## 上层包管理工具

--------

#### 查找资源库中的软件包

使用上层工具来搜索资源库元数据，可以根据软件包的名字和说明来定位它。

| 风格    | 命令                                           |
| :------ | :--------------------------------------------- |
| Red Hat | yum search search_string                       |

例如：搜索一个 yum 资源库来查找 emacs 文本编辑器，使用以下命令：

```bash
yum search emacs
```

#### 从资源库中安装一个软件包

上层工具允许从一个资源库中下载一个软件包，并经过完全依赖解析来安装它。

| 风格    | 命令                                         |
| :------ | :------------------------------------------- |
| Red Hat | yum install package_name                     |

例如：从一个 apt 资源库来安装 emacs 文本编辑器：

```bash
yum install emacs
```

#### 卸载软件

可以使用上层或者底层工具来卸载软件。下面是可用的上层工具。

| 风格    | 命令                        |
| :------ | :-------------------------- |
| Red Hat | yum erase package_name      |

例如：从 Debian 风格的系统中卸载 emacs 软件包：

```bash
yum remove emac
```

#### 经过资源库来更新软件包

最常见的软件包管理任务是保持系统中的软件包都是最新的。上层工具仅需一步就能完成 这个至关重要的任务。

| 风格    | 命令                            |
| :------ | :------------------------------ |
| Red Hat | yum update                      |

例如：更新安装在 RedHat 风格系统中的软件包：

```bash
yum update
```

#### 显示所安装软件包的信息

如果知道了所安装软件包的名字，使用以下命令可以显示这个软件包的说明信息：

| 风格    | 命令                  |
| :------ | :-------------------- |
| Red Hat | yum info package_name |

例如：查看 RedHat 风格的系统中 emacs 软件包的说明信息：

```
yum info package_name 
```

## 下层包管理工具

-------

#### 通过软件包文件来安装软件

如果从某处而不是从资源库中下载了一个软件包文件，可以使用底层工具来直接（没有经过依赖解析）安装它。

| 风格    | 命令                        |
| :------ | :-------------------------- |
| Red Hat | rpm -i package_file         |

例如：如果已经从一个并非资源库的网站下载了软件包文件 emacs-22.1-7.fc7-i386.rpm， 则可以通过这种方法来安装它：

```
rpm -i emacs-22.1-7.fc7-i386.rpm
```

> **注意：**因为这项技术使用底层的 rpm 程序来执行安装，所以没有运行依赖解析。 如果 rpm 程序发现缺少依赖，则会报错并退出。

#### 经过软件包文件来升级软件

如果已经从一个非资源库网站下载了一个软件包的最新版本，可以安装这个版本，用它来 替代先前的版本：

| 风格    | 命令                        |
| :------ | :-------------------------- |
| Red Hat | rpm -U package_file         |

例如：把 Red Hat 系统中所安装的 emacs 的版本更新到软件包文件 emacs-22.1-7.fc7-i386.rpmz 所包含的 emacs 版本。

```
rpm -U emacs-22.1-7.fc7-i386.rpm
```

#### 列出所安装的软件包

下表中的命令可以用来显示安装到系统中的所有软件包列表：

| 风格    | 命令        |
| :------ | :---------- |
| Red Hat | rpm -qa     |

```bash
rpm -qa
```

#### 确定是否安装了一个软件包

这些底端工具可以用来显示是否安装了一个指定的软件包：

| 风格    | 命令                       |
| :------ | :------------------------- |
| Red Hat | rpm -q package_name        |

例如：确定是否 Red Hat 风格的系统中安装了这个 emacs 软件包：

```
rpm -q emcs
```

#### 查找安装了某个文件的软件包

确定哪个软件包对所安装的某个特殊文件负责，使用下表中的命令：


| 风格    | 命令                    |
| :------ | :---------------------- |
| Red Hat | rpm -qf file_name       |

```
rpm -qf /usr/bin/vim
```