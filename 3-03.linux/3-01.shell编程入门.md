## shell

--------

在计算机科学中，`Shell` 俗称壳（用来区别于核），Shell是一个命令解释器，它为用户提供向 `linux` 内核发送请求以运行程序的界面系统级别程序，用户可以通过 `shell` 来启动、 挂起、停止、甚至 是编写一些程序。

> `Shell` 既是一种命令语言，又是一种程序设计语言。

在  `linux` 中有很多类型的 `shell`，不同的 `shell` 具备不同的功能，`shell` 还决定了脚本中函数的语法，`Linux` 中默认的 `shell` 是`/bin/bash`（重点），流行的shell有`ash、bash、ksh、csh、zsh`等，不同的shell都有自己的特点以及用途。

#### csh

`C shell` 使用的是“类C”语法,`csh` 是具有 `C` 语言风格的一种 `shell` ，其内部命令有 `52` 个，较为庞大。目前使用的并不多，已经被 `/bin/tcsh` 所取代。

#### ksh

`Korn shell` 的语法与 `Bourne shell` 相同，同时具备了 `C shell` 的易用特点。许多安装脚本都使用 `ksh` ，`ksh`有 `42` 条内部命令，与 `bash` 相比有一定的限制性。

#### zsh

目前 `Linux` 里最庞大的一种 `shell`：`zsh`。它有 `84` 个内部命令，使用起来也比较复杂。一般情况下，不会使用该 `shell`。

#### bash

大多数 `Linux` 系统默认使用的 `shell`，`bash shell` 是 `Bourne shell` 的一个免费版本，它是最早的 `Unix shell`，`bash`还有一个特点，可以通过 `help` 命令来查看帮助。包含的功能几乎可以涵盖 `shell` 所具有的功能，所以一般的 `shell` 脚本都会指定它为执行路径。

## Shell Script

---------

最简单的解释，一个 `shell` 脚本就是一个包含一系列命令的文件。`shell` 读取这个文件，然后执行 文件中的所有命令，就好像这些命令已经直接被输入到了命令行中一样。

`Shell` 有些独特，因为它不仅是一个功能强大的命令行接口,也是一个脚本语言解释器。我们将会看到， 大多数能够在命令行中完成的任务也能够用脚本来实现，同样地，大多数能用脚本实现的操作也能够 在命令行中完成。

### **编写shell脚本**

#### 代码规范

使用shell脚本之前要在首行声明其解释器。

```bash
#!/bin/bash				[指定告知系统当前这个脚本要使用的shell解释器]
Shell相关指令
```

#### 文件命名规范

.sh可以省略，但是这是一种规范。

```bash
文件名.sh				.sh是linux下bash shell 的默认后缀
```

#### helloworld

```bash
#! /bin/bash
# my first bash shell
echo "helloworld"
```

### **运行shell脚本：**

#### 使用sh命令：

使用 `sh` 命令不需要赋予文件可执行权限：

```bash
~/shell took 2m 1s
➜ sh ./myShell.sh
hello world
```

#### 使用相对/绝对路径：

需要先赋予可执行权限：

```bash
~/shell took 44s
➜ chmod 777 myShell.sh

~/shell
➜ ./myShell.sh
hello world
```

> **注意：**
>
> 这里在运行时一定要写成 `./test.sh`，而不是 `test.sh`，运行其它二进制的程序也一样，直接写 `test.sh`，`Linux` 系统会去 `PATH`（环境变量） 里寻找有没有叫 `test.sh` 的，而只有 `/bin, /sbin, /usr/bin，/usr/sbin` 等在 `PATH` 里，你的当前目录通常不在 `PATH` 里，所以写成 `test.sh` 是会找不到命令的，要用 `./test.sh` 告诉系统说，就在当前目录找。
>
> **脚本文件的好去处：**
>
> 这个 `~/bin` 目录是存放为个人所用脚本的好地方。多数情况下，如果所有的用户都想使用，本地支持的软件，不管脚本还是编译过的程序，都应该放到 `/usr/local` 目录下， 而不是在 `/bin` 或 `/usr/bin` 目录下。这些目录都是由 `Linux` 文件系统层次结构标准指定，只包含由 `Linux` 发行商所提供和维护的文件。
>
> **个人脚本实例：**
>
> ```bash
> export PATH=~/bin:"$PATH"
> ```
>
> 当做了这个修改之后，它会在每个新的终端会话中生效。为了把这个修改应用到当前的终端会话中， 我们必须让 `shell` 重新读取这个 `.bashrc` 文件。通过 `source .bashrc `文件来完成：
>
> ```bash
> [me@linuxbox ~]$ . .bashrc
> ```
>
> 这个点 `.` 命令是 `source` 命令的同义词，一个 `shell` 内部命令，用来读取一个指定的 `shell` 命令文件，并把它看作是从键盘中输入的一样。

## 更好的格式技巧

------

严肃认真的脚本书写，一个关键目标是为了维护方便；也就是说，一个脚本可以轻松地被作者或其它 用户修改，使它适应变化的需求。使脚本容易阅读和理解是一种方便维护的方法。

#### 长选项名称

我们学过的许多命令都以长短两种选项名称为特征。例如，这个 ls 命令有许多选项既可以用短形式也 可以用长形式来表示。例如：

```bash
[me@linuxbox ~]$ ls -ad
```

和：

```bash
[me@linuxbox ~]$ ls --all --directory
```

是等价的命令。为了减少输入，当在命令行中输入选项的时候，短选项更受欢迎，但是当书写脚本的时候，长选项能提供可读性。

#### 缩进和行继续符

当雇佣长命令的时候，通过把命令在几个文本行中展开，可以提高命令的可读性。：

```bash
[me@linuxbox ~]$ find playground \( -type f -not -perm 0600 -exec
chmod 0600 ‘{}’ ‘;’ \) -or \( -type d -not -perm 0711 -exec chmod
0711 ‘{}’ ‘;’ \)
```

显然，这个命令有点儿难理解，当第一眼看到它的时候。在脚本中，这个命令可能会比较容易 理解，如果这样书写它：

```bash
find playground \
    \( \
        -type f \
        -not -perm 0600 \
        -exec chmod 0600 ‘{}’ ‘;’ \
    \) \
    -or \
    \( \
        -type d \
        -not -perm 0711 \
        -exec chmod 0711 ‘{}’ ‘;’ \
    \)
```

通过使用行继续符（反斜杠-回车符序列）和缩进，这个复杂命令的逻辑性更清楚地描述给读者。 这个技巧在命令行中同样生效，虽然很少使用它，因为输入和编辑这个命令非常麻烦。脚本和命令行的一个区别是，脚本可能雇佣 tab 字符拉实现缩进，然而命令行却不能，因为 tab 字符被用来 激活自动补全功能。





